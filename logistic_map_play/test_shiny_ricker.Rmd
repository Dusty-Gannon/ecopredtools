---
title: "Exploring deterministic chaos"
author: "Owen"
date: "23 April 2015"
output: html_document
runtime: shiny
---

Deterministic chaos has implications for predictability...

## Simulating the Ricker model

Change the growth rate r and see how the dynamics change. At what value of r do you think the dynamics switch from being non-chaotic to chaotic?

```{r, echo=FALSE}

inputPanel(
  
  sliderInput("r", label = "Growth rate r:",
              min = 0, max = 6, value = 1, step = 0.1),
 
  numericInput("N0", "Initial abundance, population 1", 0.5),
  
  numericInput("N0.diff", "Difference in initial abundance, pop1 v. pop2", 0.000000001)
  
  
)

renderPlot({
  max_its <- 100
  N1 <- numeric(length=max_its)
  N1[1] <- input$N0
  N2 <- numeric(length=max_its)
  N2[1] <- input$N0 + input$N0.diff
  for(i in 2:max_its) {
    N1[i] <- N1[i-1] * exp(input$r * (1 - N1[i-1]))
    N2[i] <- N2[i-1] * exp(input$r * (1 - N2[i-1]))
  }
  layout(matrix(1:4, 2, 2, byrow=T))
  plot(1:max_its, N1, type="l",
       xlab="Time",
       ylab="Abundance",
       main=paste("Abundance at t = 50 is ", round(N1[50],3)),
       lwd=5)
  lines(1:max_its, N2, type="l",
       lwd=3, col="red")
  
  plot(1:max_its, log10(abs(N1-N2)), type="l",
       xlab="Time",
       ylab="Absolute difference in abundance",
       main=paste("Abundance at t = 50 is ", round(N1[50],3)),
       lwd=5)

  max.time <- 30
  x <- 1:max.time
  y <- log10(abs(N1-N2))[1:max.time]
  plot(x, y, type="p",
       xlab="Time",
       ylab="Absolute difference in abundance",
       main=paste("Growth rate of difference =",  round(coef(lm(y~x))[2],4)))
  abline(lm(y~x))

  
  
  })




```